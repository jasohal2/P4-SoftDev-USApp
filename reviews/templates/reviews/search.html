{% extends "base.html" %} {% load review_extras %} {% block content %}
<div class="page-wrapper">
  {% if query %} {% endif %} {% if users is not None %}
  <h2>User Results{% if query %} matching "{{ query }}"{% endif %}</h2>
  {% if users %}
  <ul class="user-results">
    {% for user in users %}
    <li>
      <a href="{% url 'user_profile' user.username %}">{{ user.full_name }}</a>
      <br />
      <br />
      <div class="user-metrics">
        <span
          >{{ user.review_count }} review{{ user.review_count|pluralize }}</span
        >
        <br />
        <span
          >{{ user.followers_count }} follower{{ user.followers_count|pluralize
          }}</span
        >
        <span>{{ user.following_count }} following</span>
      </div>
    </li>
    {% endfor %}
  </ul>
  {% else %}
  <p class="no-results">No users found.</p>
  {% endif %} {% endif %} {% if books is not None %}
  <h2>Book Results{% if query %} matching "{{ query }}"{% endif %}</h2>
  {% if books %}
  <ul class="book-results">
    {% for book in books %}
    <li class="book-result-item">
      <img
        src="{{ book.image.url }}"
        alt="Cover image for {{ book.title }}"
        class="book-result_img"
      />
      <div class="book-info">
        <a href="{% url 'book_detail' book.id %}">{{ book.title }}</a>
        <div class="book-rating-block">
          {% if book.avg_rating %}
          <span
            class="book-rating"
            aria-label="Rating: {{ book.avg_rating|floatformat:1 }} out of 5"
          >
            Average Rating: {% render_stars book.avg_rating %}
          </span>
          <span class="book-rating-count"
            >({{ book.avg_rating|floatformat:1 }} / 5 Â· {{ book.review_count }}
            review{{ book.review_count|pluralize }})</span
          >
          {% else %}
          <span class="book-rating no-rating">No ratings yet</span>
          {% endif %}
        </div>
      </div>
    </li>
    {% endfor %}
  </ul>
  {% else %}
  <p class="no-results">No books found.</p>
  {% endif %} {% endif %} {% if not query %}
  <p>Enter a term above to search for users and books.</p>
  {% elif users is None and books is None %}
  <p>No results yet. Try refining your search.</p>
  {% endif %} {% if user.is_authenticated %}
  <a href="{% url 'book_create' %}" class="btn">Create a new book</a>
  {% endif %}
  <br />
  <br />
</div>

{% endblock content %}
